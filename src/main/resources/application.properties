# PostgreSQL Configuration
spring.datasource.url=jdbc:postgresql://localhost:5432/estaciones_db
#spring.datasource.username=${DB_USERNAME:postgres}
#spring.datasource.password=${DB_PASSWORD:postgres}
spring.datasource.username=${DB_USERNAME:user_estaciones}
spring.datasource.password=${DB_PASSWORD:lkj456}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.default_schema=public

# Generar DDL en archivo (desarrollo) - DESACTIVADO
# Usar src/main/resources/db/schema.sql como fuente de verdad
# spring.jpa.properties.jakarta.persistence.schema-generation.scripts.action=create
# spring.jpa.properties.jakarta.persistence.schema-generation.scripts.create-target=schema.sql
# spring.jpa.properties.jakarta.persistence.schema-generation.scripts.create-source=metadata

# Connection Pool (HikariCP)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000

# Spring Batch
spring.batch.job.enabled=false
spring.batch.initialize-schema=always
spring.batch.schema=classpath:org/springframework/batch/core/schema-postgresql.sql
spring.batch.table-prefix=batch_

# SQL Scripts - Ejecutar schema.sql automáticamente al iniciar
# Esto creará funciones, vistas y tablas de batch que Hibernate no puede crear
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:db/schema.sql
spring.sql.init.continue-on-error=true
# No usar separador personalizado para permitir funciones PL/pgSQL con $$
# Spring Boot ejecutará el script completo y PostgreSQL manejará los delimitadores
# API Externa - Ministerio de Energía
api.energia.base-url=https://energia.serviciosmin.gob.es/ServiciosRESTCarburantes/PreciosCarburantes

# Logging
logging.level.com.estaciones=DEBUG
logging.level.org.springframework.batch=INFO
logging.level.org.hibernate.SQL=DEBUG

# Logging detallado para Spring Batch
logging.level.org.springframework.batch.core.repository.dao=DEBUG
logging.level.org.springframework.jdbc.core.JdbcTemplate=DEBUG

# OpenAPI/Swagger
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.default-produces-media-type=application/json
springdoc.default-consumes-media-type=application/json

# Logging para verificar conexión
logging.level.org.springframework.jdbc.datasource=DEBUG
logging.level.org.springframework.batch.core.repository.support=DEBUG

